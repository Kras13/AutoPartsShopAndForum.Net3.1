@model ProductQueryViewModel

@{
    ViewData["Title"] = "View Products";
}

@{
    double lastPage = 1;

    if (Model.TotalProducts > 0)
    {
        lastPage = Math.Ceiling((double)Model.TotalProducts / Model.ProductsPerPage);
    }
}

<form method="get">
    <div class="container">
        <div class="bg-white rounded d-flex align-items-center justify-content-between" id="header">
            <button class="btn btn-hide text-uppercase" type="button" data-toggle="collapse" data-target="#filterbar" aria-expanded="false" aria-controls="filterbar" id="filter-btn" onclick="changeBtnTxt()"> <span class="fas fa-angle-left" id="filter-angle"></span> <span id="btn-txt">Hide filters</span> </button>
            <nav class="navbar navbar-expand-lg navbar-light pl-lg-0 pl-auto">
                <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#mynav" aria-controls="mynav" aria-expanded="false" aria-label="Toggle navigation" onclick="chnageIcon()" id="icon"> <span class="navbar-toggler-icon"></span> </button>
                <div class="collapse navbar-collapse" id="mynav">
                    <ul class="navbar-nav d-lg-flex align-items-lg-center">
                        <li class="nav-item active">
                            <select asp-for="Sorting" class="form-control" onchange="this.form.submit()">
                                <option value="" hidden selected>Sort by</option>
                                <option value="0">No sorting</option>
                                <option value="1">Price ascending</option>
                                <option value="2">Price descending</option>
                                <option value="3">Name ascending</option>
                                <option value="4">Name descending</option>
                                <option value="5">Date added ascending</option>
                                <option value="6">Date added descending</option>
                            </select>
                        </li>
                    </ul>
                </div>
            </nav>
            <div class="ml-auto mt-3 mr-2">
                <nav aria-label="Search">
                    <ul class="pagination">
                        <li class="nav-item active">
                            <input asp-for="SearchCriteria" class="form-control" placeholder="Bardahl, Man, Motul.....">
                        </li>
                    </ul>
                </nav>
            </div>
            <div class="ml-auto mt-3 mr-2">
                <nav aria-label="Page navigation example">
                    <ul class="pagination">
                        <li class="page-item">
                            <a class="btn btn-primary @(Model.CurrentPage == 1 ? "disabled" : string.Empty) float-left"
                               asp-controller="Products"
                               asp-action="All"
                               asp-route-currentpage="@(Model.CurrentPage > 0 ? Model.CurrentPage - 1 : 1)"
                               asp-route-categoryid="@Model.CategoryId"
                               asp-route-searchcriteria="@Model.SearchCriteria"
                               asp-route-sorting="@((int)Model.Sorting)">Previous</a>
                        </li>
                        <li class="page-item active"><a class="page-link" href="#">@Model.CurrentPage</a></li>
                        <li class="page-item">
                            <a class="btn btn-primary @(Model.CurrentPage == lastPage ? "disabled" : string.Empty) float-left"
                               asp-controller="Products"
                               asp-action="All"
                               asp-route-currentpage="@(Model.CurrentPage > 0 ? Model.CurrentPage + 1 : 1)"
                               asp-route-categoryid="@Model.CategoryId"
                               asp-route-searchcriteria="@Model.SearchCriteria"
                               asp-route-sorting="@((int)Model.Sorting)">Next</a>
                        </li>
                    </ul>
                </nav>
            </div>
        </div>
        <div id="content" class="my-5">
            <div id="filterbar" class="collapse">
                <div class="box border-bottom">
                    <div class="form-group text-center">
                        <input class="btn btn-primary" type="submit" value="Apply" />
                        <a class="btn btn-danger" asp-controller="Products" asp-action="All"
                           asp-route-categoryid="@Model.CategoryId"
                           asp-route-sorting="@Model.Sorting"
                           asp-route-searchcriteria="@Model.SearchCriteria">Reset</a>
                    </div>
                </div>
                <div class="box border-bottom">
                    <div class="box-label text-uppercase d-flex align-items-center">Subcategories <button class="btn ml-auto" type="button" data-toggle="collapse" data-target="#inner-box" aria-expanded="false" aria-controls="inner-box" id="out" onclick="outerFilter()"> <span class="fas fa-plus"><img src="~/img/plus.png"></span></button></div>
                    <div id="inner-box" class="collapse mt-2 mr-1">
                        @for (int i = 0; i < Model.SubCategories.Count; i++)
                        {
                            <div class="my-1">
                                <input type="hidden" asp-for="@Model.SubCategories[i].Id" />
                                <input type="hidden" asp-for="@Model.SubCategories[i].Name" />
                                <label asp-for="@Model.SubCategories[i].Selected">@(Model.SubCategories[i].Name)</label>
                                <input asp-for="@Model.SubCategories[i].Selected" />
                            </div>
                        }
                        <input type="hidden" asp-for="@Model.CategoryId" value="@Model.CategoryId">
                    </div>
                </div>
            </div>
            <div id="products">
                <div class="row mx-0">
                    @foreach (var product in Model.Products)
                    {
                        <div class="col-lg-4 col-md-6 pt-md-4 pt-3">
                            <div class="card d-flex flex-column align-items-center">
                                <div class="product-name text-center">@product.Name</div>
                                <a asp-controller="Products" asp-action="Details"
                                   asp-route-id="@product.Id"
                                   asp-route-name="@product.Name"
                                   asp-route-description="@product.Description"
                                   asp-route-price="@product.Price"
                                   asp-route-imageurl="@product.ImageUrl"
                                   asp-route-subcategoryid="@product.SubcategoryId">
                                    <div class="card-img">
                                        <img src="@product.ImageUrl" alt="">
                                    </div>
                                </a>
                                <div class="card-body pt-5">
                                    <div class="d-flex align-items-center justify-content-center price">
                                        <div class="font-weight-bold">@product.Price leva</div>
                                    </div>
                                    <a class="btn btn-danger float-right"
                                       asp-controller="Cart" asp-action="Add"
                                       asp-route-id="@product.Id"
                                       asp-route-name="@product.Name"
                                       asp-route-price="@product.Price"
                                       asp-route-quantity="1"
                                       asp-route-imageurl="@product.ImageUrl"
                                       asp-route-description="@product.Description">Buy</a>
                                </div>
                            </div>
                        </div>
                    }
                </div>
            </div>
        </div>
    </div>

</form>



@*<div class="catsummary" Model.Products>
        @foreach (var product in Model.Products)
        {
            <div class="categoryinfo">
                <div class="prodBox">
                    <img src="@(product.ImageUrl)" class="prod_img_icon" alt="Alternate Text" />
                </div>
                <div class="category_title">
                    <a asp-controller="Products"
                       asp-action="Details"
                       asp-route-id="@product.Id"
                       asp-route-name="@product.Name"
                       asp-route-desctiption="@product.Desctiption"
                       asp-route-price="@product.Price"
                       asp-route-imageurl="@product.ImageUrl"
                       asp-route-categoryid="@product.CategoryId"
                       class="btn btn-warning">@(product.Name)</a>
                </div>
                <div class="price_discounted">@product.Price</div>
                <div class="row">
                    <div class="col-md-6">
                        <a asp-controller="Products"
                           asp-action="Details"
                           asp-route-id="@product.Id"
                           asp-route-name="@product.Name"
                           asp-route-desctiption="@product.Desctiption"
                           asp-route-price="@product.Price"
                           asp-route-imageurl="@product.ImageUrl"
                           asp-route-categoryid="@product.CategoryId"
                           class="btn btn-info">Info</a>
                    </div>
                    <div class="col-md-6">
                        @*<input class="btn btn-outline-danger" type="submit" value="Buy" /> end of first
    <button type="button" class="btn btn-primary" data-toggle="modal" data-target="#exampleModal">
        Buy
    </button>

    <div class="modal fade" id="exampleModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="exampleModalLabel">Add to Cart</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    Are you sure you want to add the selected product to the cart?
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Continue shopping</button>
                    <a class="btn btn-danger float-right"
                       asp-controller="Cart" asp-action="Add"
                       asp-route-id="@product.Id"
                       asp-route-name="@product.Name"
                       asp-route-price="@product.Price"
                       asp-route-quantity="1">Buy</a>
                </div>
            </div>
        </div>
    </div>
                    </div>
                </div>
            </div>
        }
    </div>*@
